Continuing the GalaPo city directory project. Set up the backend foundation.

TECH STACK:
- Next.js 16 App Router (already set up)
- Supabase (Free Tier) for database, auth, and storage
- TypeScript

REQUIREMENTS:
1. Install Supabase JS SDK v2 (latest 2026 version)

2. Create Supabase client configuration at /lib/supabase.ts:
   - Browser client (for client components)
   - Server client (for server components and route handlers)
   - Admin client (for super admin operations with service role key)
   - Use environment variables: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY, SUPABASE_SERVICE_ROLE_KEY

3. Create /lib/supabase-middleware.ts for auth session handling in middleware

4. Create middleware.ts at project root:
   - Protect /(business)/* routes → redirect to /login if not authenticated business owner
   - Protect /(admin)/* routes → redirect to /admin/login if not authenticated super admin
   - Allow all /(public)/* routes without auth
   - Refresh auth session on every request

5. Create .env.local template with all required environment variables:
   - NEXT_PUBLIC_SUPABASE_URL
   - NEXT_PUBLIC_SUPABASE_ANON_KEY
   - SUPABASE_SERVICE_ROLE_KEY
   - NEXT_PUBLIC_APP_URL
   - RESEND_API_KEY

6. Create TypeScript type definitions at /lib/types.ts for:
   - User (id, email, role, created_at, updated_at)
   - UserRole enum (SUPER_ADMIN, BUSINESS_OWNER)
   - BusinessListing (id, slug, business_name, category_id, subcategory_id, status, is_featured, is_premium, owner_id, city_slug, barangay_id, address, lat, lng, phone, email, website, social_links, operating_hours, short_description, full_description, tags, payment_methods, logo_url, created_at, updated_at, last_verified_at, is_active)
   - ListingStatus enum (PENDING, APPROVED, REJECTED, CLAIMED_PENDING)
   - Category (id, name, slug, icon, parent_id, sort_order, is_active)
   - DynamicField (id, category_id, field_name, field_label, field_type, is_required, options, sort_order)
   - FieldType enum (TEXT, TEXTAREA, NUMBER, CURRENCY, BOOLEAN, SELECT, MULTI_SELECT, URL, PHONE, EMAIL, IMAGE_GALLERY, MENU_ITEMS, TIME_RANGE, JSON)
   - ListingFieldValue (id, listing_id, field_id, value)
   - Barangay (id, name, slug, city_slug, is_active, sort_order)
   - Deal (id, listing_id, title, description, image_url, start_date, end_date, is_active)
   - Event (id, listing_id, title, description, image_url, event_date, start_time, end_time, venue, is_city_wide, is_featured, created_by)
   - BlogPost (id, title, slug, content, excerpt, featured_image, tags, linked_listings, is_published, author_id, created_at, updated_at)
   - Subscription (id, listing_id, plan_type, status, start_date, end_date, amount)
   - PlanType enum (FREE, FEATURED, PREMIUM)
   - SubscriptionStatus enum (ACTIVE, EXPIRED, PENDING_PAYMENT, CANCELLED)
   - Payment (id, subscription_id, listing_id, amount, payment_method, payment_proof_url, status, verified_by, verified_at, created_at)
   - PaymentStatus enum (PENDING, VERIFIED, REJECTED)
   - Invoice (id, payment_id, listing_id, invoice_number, amount, description, issued_at, due_date)
   - AdPlacement (id, title, image_url, target_url, placement_location, listing_id, start_date, end_date, impressions, clicks, is_active, is_adsense, created_at)
   - PlacementLocation enum (HOMEPAGE_BANNER, SEARCH_SIDEBAR, SEARCH_INLINE, LISTING_BANNER, LISTING_SIDEBAR, CATEGORY_BANNER, BLOG_INLINE, BLOG_SIDEBAR)
   - Notification (id, user_id, type, title, message, is_read, data, created_at)
   - StaticPage (id, title, slug, content, meta_title, meta_description, is_published, updated_at)
   - SiteSettings (id, key, value, updated_at)
   - AnnualCheck (id, listing_id, check_date, response_deadline, status, responded_at)
   - AnnualCheckStatus enum (PENDING, CONFIRMED, NO_RESPONSE, DEACTIVATED)
   - ReactivationFee (id, amount, is_active)

7. Create /lib/utils.ts with helper functions:
   - generateSlug(text: string): string
   - formatCurrency(amount: number): string
   - formatDate(date: string): string
   - formatPhone(phone: string): string
   - generateInvoiceNumber(): string
   - truncateText(text: string, length: number): string

Output all files with complete code. Use latest 2026 Supabase SDK syntax.