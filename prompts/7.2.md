Continuing the GalaPo project. Build the backend authentication system.

TECH: Next.js 16 Route Handlers, Supabase Auth, TypeScript

REQUIREMENTS:

1. /app/api/auth/register/route.ts:
   - POST: Register a new business owner
   - Body: { email, password, full_name, phone }
   - Validation:
     - Email format
     - Password min 8 characters
     - Full name required
     - Phone required (PH format)
   - Process:
     1. Create Supabase auth user with email/password
     2. Profile auto-created by database trigger (from Module 2)
     3. Update profile with full_name, phone, role='business_owner'
     4. Return: { user, profile, session }
   - Error handling:
     - Email already exists → 409 Conflict
     - Invalid email format → 400 Bad Request
     - Weak password → 400 Bad Request

2. /app/api/auth/login/route.ts:
   - POST: Login business owner
   - Body: { email, password }
   - Process:
     1. Sign in with Supabase Auth
     2. Fetch profile
     3. Verify role is 'business_owner' (not super_admin — they use different login)
     4. Return: { user, profile, session }
   - Error handling:
     - Invalid credentials → 401 Unauthorized
     - Account disabled → 403 Forbidden

3. /app/api/auth/logout/route.ts:
   - POST: Logout
   - Clear Supabase session
   - Return: { success: true }

4. /app/api/auth/forgot-password/route.ts:
   - POST: Send password reset email
   - Body: { email }
   - Uses Supabase auth resetPasswordForEmail
   - Reset link redirects to: /reset-password
   - Always return success (don't reveal if email exists for security)

5. /app/api/auth/reset-password/route.ts:
   - POST: Update password with reset token
   - Body: { new_password }
   - Uses Supabase auth updateUser
   - Return success or error

6. /app/api/auth/session/route.ts:
   - GET: Get current session and profile
   - Returns: { user, profile, session } or { user: null } if not authenticated
   - Used by AuthProvider to check auth state on page load

7. /app/api/auth/profile/route.ts:
   - GET: Get current user's profile
   - PUT: Update profile (full_name, phone, avatar_url)
   - Validation on update
   - Only allows updating own profile

8. /app/api/notifications/route.ts:
   - GET: Fetch notifications for current user
   - Query params: ?unread_only=true, ?page=1, ?limit=20
   - Order by: created_at DESC
   - Return with unread_count

9. /app/api/notifications/[id]/read/route.ts:
   - PATCH: Mark single notification as read
   - Only owner can mark their own notifications

10. /app/api/notifications/read-all/route.ts:
    - PATCH: Mark all notifications as read for current user

11. UPDATE middleware.ts:
    - Protect all /business/* routes
    - Check Supabase session
    - If no session → redirect to /login
    - If session exists but profile role is not 'business_owner' → redirect to /login with error param
    - Allow /api/auth/* routes without auth
    - Refresh session token on each request

12. CREATE /lib/auth-helpers.ts:
    - getServerSession(): get session in server components
    - getServerProfile(): get profile in server components
    - requireBusinessOwner(request): middleware helper for API routes
    - validateEmail(email): boolean
    - validatePhone(phone): boolean (PH format)
    - validatePassword(password): { isValid: boolean, strength: 'weak' | 'medium' | 'strong', message: string }

Output all files with complete code.